<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="data_handle" href="../src/data_handle.html" /><link rel="prev" title="Tutorial" href="../src/tutorial.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>das4whales package - DAS4Whales documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #005f73;
  --color-brand-content: #0a9396;
  --color-background-primary: #ffffff;
  --color-background-secondary: #e0fbfc;
  --color-foreground-primary: #023047;
  --color-foreground-secondary: #8ecae6;
  --color-link: #ffb703;
  --color-link--hover: #fb8500;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #0a9396;
  --color-brand-content: #94d2bd;
  --color-background-primary: #001219;
  --color-background-secondary: #003049;
  --color-foreground-primary: #e0fbfc;
  --color-foreground-secondary: #94d2bd;
  --color-link: #ffb703;
  --color-link--hover: #fb8500;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #0a9396;
  --color-brand-content: #94d2bd;
  --color-background-primary: #001219;
  --color-background-secondary: #003049;
  --color-foreground-primary: #e0fbfc;
  --color-foreground-secondary: #94d2bd;
  --color-link: #ffb703;
  --color-link--hover: #fb8500;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">DAS4Whales  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">DAS4Whales  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/tutorial.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules documentation</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">das4whales package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/data_handle.html">data_handle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/dsp.html">dsp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/detect.html">detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/plot.html">plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/graph.html">Graph of Modules and Functions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/das4whales.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-das4whales">
<span id="das4whales-package"></span><h1>das4whales package<a class="headerlink" href="#module-das4whales" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-das4whales.dask_wrap">
<span id="das4whales-dask-wrap-module"></span><h2>das4whales.dask_wrap module<a class="headerlink" href="#module-das4whales.dask_wrap" title="Link to this heading">¶</a></h2>
<p>dask_wrap.py - Dask wrapper functions for DAS data processing</p>
<p>This module provides functions to wrap up the functions of das4whales in a dask way.</p>
<p>Authors: Léa Bouffaut, Quentin Goestchel
Date: 2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dask_wrap.load_das_data">
<span class="sig-prename descclassname"><span class="pre">das4whales.dask_wrap.</span></span><span class="sig-name descname"><span class="pre">load_das_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dask_wrap.html#load_das_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dask_wrap.load_das_data" title="Link to this definition">¶</a></dt>
<dd><p>Load the DAS data corresponding to the input file name as strain according to the selected channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The full path to the data to load.</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list containing the start, stop, and step values for selecting channels.</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – A dictionary filled with metadata (sampling frequency, channel spacing, scale factor, etc.).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.ndarray</em> – A [channel x sample] numpy array containing the strain data.</p></li>
<li><p><em>np.ndarray</em> – The corresponding time axis (s).</p></li>
<li><p><em>np.ndarray</em> – The corresponding distance along the FO cable axis (m).</p></li>
<li><p><em>datetime.datetime</em> – The beginning time of the file.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the file is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dask_wrap.raw2strain">
<span class="sig-prename descclassname"><span class="pre">das4whales.dask_wrap.</span></span><span class="sig-name descname"><span class="pre">raw2strain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dask_wrap.html#raw2strain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dask_wrap.raw2strain" title="Link to this definition">¶</a></dt>
<dd><p>Convert a daskarray filled of int32 to a</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tr</strong> (<em>dask.array.core.Array</em>) – daskarray built on the HDF5 pointer</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – dictionary of metadata</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of selected spatial indexes and spatial step</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>daskarray filled with scaled float64</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dask.array.core.Array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.data_handle">
<span id="das4whales-data-handle-module"></span><h2>das4whales.data_handle module<a class="headerlink" href="#module-das4whales.data_handle" title="Link to this heading">¶</a></h2>
<p>data_handle.py - data handling functions for DAS data</p>
<p>This module provides various functions to handle DAS data, including loading, downloading, and conditioning.
It aims at having specific functions for each interrogator type.</p>
<p>Authors: Léa Bouffaut, Quentin Goestchel, Erfan Horeh
Date: 2023-2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.calc_dist_to_xidx">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">calc_dist_to_xidx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#calc_dist_to_xidx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.calc_dist_to_xidx" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the index of the channel closest to the given distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The distance along the cable.</p></li>
<li><p><strong>selected_channels_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – The selected channels in meters.</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – The selected channels.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The distance between two channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index of the channel closest to the given distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.dl_file">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">dl_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#dl_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.dl_file" title="Link to this definition">¶</a></dt>
<dd><p>Download the file at the given url</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<em>string</em>) – url location of the file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filepath</strong> – local path destination of the file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.get_acquisition_parameters">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">get_acquisition_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interrogator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'optasense'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#get_acquisition_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.get_acquisition_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve acquisition parameters based on the specified interrogator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The file path to the data file.</p></li>
<li><p><strong>interrogator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The interrogator type, one of {‘optasense’, ‘silixa’, ‘mars’, ‘alcatel’, ‘onyx’}.
Defaults to ‘optasense’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metadata</strong> – Metadata related to the acquisition parameters. Returns None if no matching
interrogator is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a> or None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the interrogator name is not in the predefined list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.get_metadata_onyx">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">get_metadata_onyx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#get_metadata_onyx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.get_metadata_onyx" title="Link to this definition">¶</a></dt>
<dd><p>Gets DAS acquisition parameters for the onyx interrogator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>string</em>) – a string containing the full path to the data to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>metadata</strong> – dictionary filled with metadata, key’s breakdown:</p>
<p>fs: the sampling frequency (Hz)</p>
<p>dx: interval between two virtual sensing points also called channel spacing (m)</p>
<p>nx: the number of spatial samples also called channels</p>
<p>ns: the number of time samples</p>
<p>n: refractive index of the fiber</p>
<p>GL: the gauge length (m)</p>
<p>scale_factor: the value to convert DAS data from strain rate to strain</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.get_metadata_optasense">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">get_metadata_optasense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#get_metadata_optasense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.get_metadata_optasense" title="Link to this definition">¶</a></dt>
<dd><p>Gets DAS acquisition parameters for the optasense interrogator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>string</em>) – a string containing the full path to the data to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>metadata</strong> – dictionary filled with metadata, key’s breakdown:</p>
<p>fs: the sampling frequency (Hz)</p>
<p>dx: interval between two virtual sensing points also called channel spacing (m)</p>
<p>nx: the number of spatial samples also called channels</p>
<p>ns: the number of time samples</p>
<p>n: refractive index of the fiber</p>
<p>GL: the gauge length (m)</p>
<p>scale_factor: the value to convert DAS data from strain rate to strain</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.get_metadata_silixa">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">get_metadata_silixa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#get_metadata_silixa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.get_metadata_silixa" title="Link to this definition">¶</a></dt>
<dd><p>Gets DAS acquisition parameters for the silixa interrogator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>string</em>) – a string containing the full path to the data to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>metadata</strong> – dictionary filled with metadata, key’s breakdown:</p>
<p>fs: the sampling frequency (Hz)</p>
<p>dx: interval between two virtual sensing points also called channel spacing (m)</p>
<p>nx: the number of spatial samples also called channels</p>
<p>ns: the number of time samples</p>
<p>n: refractive index of the fiber</p>
<p>GL: the gauge length (m)</p>
<p>scale_factor: the value to convert DAS data from strain rate to strain</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.get_selected_channels">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">get_selected_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selected_channels_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#get_selected_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.get_selected_channels" title="Link to this definition">¶</a></dt>
<dd><p>Get the selected channels in channel numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selected_channels_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – The selected channels in meters. [ChannelStart_m, ChannelStop_m, ChannelStep_m]</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The distance between two channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selected channels in channel numbers. [ChannelStart, ChannelStop, ChannelStep]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.hello_world_das_package">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">hello_world_das_package</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#hello_world_das_package"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.hello_world_das_package" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.load_cable_coordinates">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">load_cable_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#load_cable_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.load_cable_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Load the cable coordinates from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The file path to the cable coordinates file.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The distance between two channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – The cable coordinates dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.load_das_data">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">load_das_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#load_das_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.load_das_data" title="Link to this definition">¶</a></dt>
<dd><p>Load the DAS data corresponding to the input file name as strain according to the selected channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – A string containing the full path to the data to load.</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list containing the selected channels.</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – A dictionary filled with metadata (sampling frequency, channel spacing, scale factor…).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x sample] nparray containing the strain data.</p></li>
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – The corresponding time axis (s).</p></li>
<li><p><strong>dist</strong> (<em>np.ndarray</em>) – The corresponding distance along the FO cable axis (m).</p></li>
<li><p><strong>file_begin_time_utc</strong> (<em>datetime.datetime</em>) – The beginning time of the file, can be printed using file_begin_time_utc.strftime(“%Y-%m-%d %H:%M:%S”).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.load_mtpl_das_data">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">load_mtpl_das_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepaths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#load_mtpl_das_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.load_mtpl_das_data" title="Link to this definition">¶</a></dt>
<dd><p>Load the DAS data corresponding to the input file names as strain according to the selected channels. Takes multiple files as input and concatenates them along the time axis starting from the input timestamp for the input time window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepaths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list containing the full pathes to the data to load.</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list containing the selected channels.</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – A dictionary filled with metadata (sampling frequency, channel spacing, scale factor…).</p></li>
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The timestamp to extract the data from.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The time window duration to extract the data from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x sample] nparray containing the strain data.</p></li>
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – The corresponding time axis (s).</p></li>
<li><p><strong>dist</strong> (<em>np.ndarray</em>) – The corresponding distance along the FO cable axis (m).</p></li>
<li><p><strong>file_begin_time_utc</strong> (<em>datetime.datetime</em>) – The beginning time of the file, can be printed using file_begin_time_utc.strftime(“%Y-%m-%d %H:%M:%S”).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.data_handle.raw2strain">
<span class="sig-prename descclassname"><span class="pre">das4whales.data_handle.</span></span><span class="sig-name descname"><span class="pre">raw2strain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/data_handle.html#raw2strain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.data_handle.raw2strain" title="Link to this definition">¶</a></dt>
<dd><p>Transform the amplitude of raw das data from strain-rate to strain according to scale factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>array-like</em>) – a [channel x time sample] nparray containing the raw data in the spatio-temporal domain</p></li>
<li><p><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – dictionary filled with metadata (fs, dx, nx, ns, n, GL, scale_factor)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>trace</strong> – a [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.detect">
<span id="das4whales-detect-module"></span><h2>das4whales.detect module<a class="headerlink" href="#module-das4whales.detect" title="Link to this heading">¶</a></h2>
<p>detect.py - Detection module of DAS4Whales package</p>
<p>This module provides functions for detecting whale calls in DAS strain data.</p>
<p>Author: Quentin Goestchel
Date: 2023-2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.buildkernel">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">buildkernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdwdth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#buildkernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.buildkernel" title="Link to this definition">¶</a></dt>
<dd><p>Calculate kernel and plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Starting frequency.</p></li>
<li><p><strong>f1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Ending frequency.</p></li>
<li><p><strong>bdwdth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Frequency width of call.</p></li>
<li><p><strong>dur</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Call length (seconds).</p></li>
<li><p><strong>f</strong> (<em>np.array</em>) – Vector of frequencies returned from plotwav.</p></li>
<li><p><strong>t</strong> (<em>np.array</em>) – Vector of times returned from plotwav.</p></li>
<li><p><strong>samp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sample rate.</p></li>
<li><p><strong>plotflag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, plots kernel. If False, no plot. Default is False.</p></li>
<li><p><strong>kernel_lims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Tuple of minimum kernel range and maximum kernel range. Default is finKernelLims.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tvec</strong> (<em>numpy.array</em>) – Vector of kernel times.</p></li>
<li><p><strong>fvec_sub</strong> (<em>numpy.array</em>) – Vector of kernel frequencies.</p></li>
<li><p><strong>BlueKernel</strong> (<em>2-d numpy.array</em>) – Matrix of kernel values.</p></li>
<li><p><em>Key variables</em></p></li>
<li><p><em>————-</em></p></li>
<li><p><strong>tvec</strong> (<em>numpy.array</em>) – Kernel times (seconds).</p></li>
<li><p><strong>fvec</strong> (<em>numpy.array</em>) – Kernel frequencies.</p></li>
<li><p><strong>BlueKernel</strong> (<em>numpy.array</em>) – Matrix of kernel values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.buildkernel_from_template">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">buildkernel_from_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#buildkernel_from_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.buildkernel_from_template" title="Link to this definition">¶</a></dt>
<dd><p>Build a kernel from a template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The minimum frequency of interest.</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The maximum frequency of interest.</p></li>
<li><p><strong>dur</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The duration of the kernel in seconds.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling rate of the kernel in Hz.</p></li>
<li><p><strong>nperseg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The length of each segment for the spectrogram computation.</p></li>
<li><p><strong>nhop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of samples to advance between segments.</p></li>
<li><p><strong>plotflag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to plot the kernel, defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.calc_nmf">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">calc_nmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#calc_nmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.calc_nmf" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the normalized matched filter between the input data and the template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – The input data array.</p></li>
<li><p><strong>template</strong> (<em>numpy.ndarray</em>) – The template array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalized matched filter array (vector).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.calc_nmf_correlogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">calc_nmf_correlogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#calc_nmf_correlogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.calc_nmf_correlogram" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the normalized matched filter correlogram between the input data and the template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – The input data array.</p></li>
<li><p><strong>template</strong> (<em>numpy.ndarray</em>) – The template array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalized matched filter correlogram array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.compute_cross_correlogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">compute_cross_correlogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#compute_cross_correlogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.compute_cross_correlogram" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross correlogram between the given data and template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – The input data array.</p></li>
<li><p><strong>template</strong> (<em>numpy.ndarray</em>) – The template array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cross correlogram array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.compute_cross_correlogram_spectrocorr">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">compute_cross_correlogram_spectrocorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_pct</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#compute_cross_correlogram_spectrocorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.compute_cross_correlogram_spectrocorr" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-correlogram via spectrogram correlation.</p>
<p>This function computes the cross-correlogram spectrocorr between the input data and a kernel.
The cross-correlogram spectrocorr is a measure of similarity between the spectrogram of the input data
and the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Input data array of shape (n, m), where n is the number of samples and m is the number of channels.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sampling frequency of the input data.</p></li>
<li><p><strong>flims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – Frequency limits (fmin, fmax) for the spectrogram computation.</p></li>
<li><p><strong>kernel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary containing the kernel parameters (f0, f1, duration, bandwidth).</p></li>
<li><p><strong>win_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Window size in seconds for the spectrogram computation.</p></li>
<li><p><strong>overlap_pct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Percentage of overlap between consecutive windows for the spectrogram computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cross_correlogram</strong> – Cross-correlogram spectrocorr array of shape (n, p), where n is the number of samples and p is the number of time bins.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.convert_pick_times">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">convert_pick_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks_indexes_m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#convert_pick_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.convert_pick_times" title="Link to this definition">¶</a></dt>
<dd><p>Convert pick times from a list of lists to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>peaks_indexes_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>lists</em>) – A list of lists containing the pick times. The indexes of each list correspond to the space index.
[[t1, t2, t3, …], [t1, t2, t3, …], …]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing a tuple (time index, spatial index) of the converted pick times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.gen_hyperbolic_chirp">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">gen_hyperbolic_chirp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#gen_hyperbolic_chirp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.gen_hyperbolic_chirp" title="Link to this definition">¶</a></dt>
<dd><p>Generate a hyperbolic chirp signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The ending frequency of the chirp signal.</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The starting frequency of the chirp signal.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The duration of the chirp signal in seconds.</p></li>
<li><p><strong>sampling_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The sampling rate of the chirp signal in Hz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated hyperbolic chirp signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.gen_linear_chirp">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">gen_linear_chirp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#gen_linear_chirp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.gen_linear_chirp" title="Link to this definition">¶</a></dt>
<dd><p>Generate a linear chirp signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The ending frequency of the chirp signal.</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The starting frequency of the chirp signal.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The duration of the chirp signal in seconds.</p></li>
<li><p><strong>sampling_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The sampling rate of the chirp signal in Hz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated linear chirp signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.gen_template_fincall">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">gen_template_fincall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#gen_template_fincall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.gen_template_fincall" title="Link to this definition">¶</a></dt>
<dd><p>generate template of a fin whale call</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – time vector</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum frequency, by default 15</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum frequency, by default 25</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Duration of the chirp signal in seconds, by default 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.get_sliced_nspectrogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">get_sliced_nspectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#get_sliced_nspectrogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.get_sliced_nspectrogram" title="Link to this definition">¶</a></dt>
<dd><p>Compute the sliced non-stationary spectrogram of a given trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.ndarray</em>) – The input trace signal.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling rate of the trace signal.</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The minimum frequency of interest.</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The maximum frequency of interest.</p></li>
<li><p><strong>nperseg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The length of each segment for the spectrogram computation.</p></li>
<li><p><strong>nhop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of samples to advance between segments.</p></li>
<li><p><strong>plotflag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to plot the spectrogram, defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spectrogram</strong> (<em>numpy.ndarray</em>) – The computed spectrogram.</p></li>
<li><p><strong>ff</strong> (<em>ndarray</em>) – The frequency values of the spectrogram.</p></li>
<li><p><strong>tt</strong> (<em>ndarray</em>) – The time values of the spectrogram.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function computes the non-stationary spectrogram of a given trace signal.
The spectrogram is computed using the Short-Time Fourier Transform (STFT) with
a specified segment length and hop size. The resulting spectrogram is then sliced
between the specified minimum and maximum frequencies of interest.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmin</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nperseg</span> <span class="o">=</span> <span class="mi">256</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nhop</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrogram</span><span class="p">,</span> <span class="n">ff</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="n">get_sliced_nspectrogram</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nperseg</span><span class="p">,</span> <span class="n">nhop</span><span class="p">,</span> <span class="n">plotflag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.nxcorr2d">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">nxcorr2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#nxcorr2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.nxcorr2d" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the normalized cross-correlation between a spectrogram and a kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectro</strong> (<em>numpy.ndarray</em>) – The spectrogram array.</p></li>
<li><p><strong>kernel</strong> (<em>numpy.ndarray</em>) – The kernel array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The maximum correlation values along the time axis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The normalized cross-correlation is calculated using <cite>scipy.signal.correlate2d</cite>.
The correlation values are normalized by dividing by the standard deviation of the spectrogram and the kernel,
multiplied by the number of columns in the spectrogram.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spectro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxcorr2d</span><span class="p">(</span><span class="n">spectro</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="go">array([0.        , 0.33333333, 0.66666667])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.pick_times">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">pick_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipi_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#pick_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.pick_times" title="Link to this definition">¶</a></dt>
<dd><p>Detects the peak times in a correlation matrix.</p>
<p>This function takes a correlation matrix, computes the Hilbert transform of each correlation,
and detects the peak times based on a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_m</strong> (<em>numpy.ndarray</em>) – The correlation matrix.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The threshold value for peak detection. Defaults to 0.3.</p></li>
<li><p><strong>ipi_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The minimum inter-pulse interval in indexes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of arrays, where each array contains the peak indexes for each correlation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.pick_times_env">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">pick_times_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#pick_times_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.pick_times_env" title="Link to this definition">¶</a></dt>
<dd><p>Detects the peak times in a correlation matrix. Parallelized version : pick_times_par</p>
<p>This function takes a correlation matrix, computes the Hilbert transform of each correlation,
and detects the peak times based on a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_m</strong> (<em>numpy.ndarray</em>) – The correlation matrix.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The threshold value for peak detection. Defaults to 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of arrays, where each array contains the peak indexes for each correlation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.pick_times_par">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">pick_times_par</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#pick_times_par"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.pick_times_par" title="Link to this definition">¶</a></dt>
<dd><p>Detects the peak times in a correlation matrix using parallel processing.</p>
<p>This function takes a correlation matrix, computes the Hilbert transform of each correlation,
and detects the peak times based on a given threshold using parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_m</strong> (<em>numpy.ndarray</em>) – The correlation matrix.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The threshold value for peak detection. Defaults to 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of arrays, where each array contains the peak indexes for each correlation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.process_corr">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">process_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#process_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.process_corr" title="Link to this definition">¶</a></dt>
<dd><p>Detects the peak times in a correlation serie, kernel for parallelization.</p>
<p>This function takes a correlation serie, computes the Hilbert transform of the correlation, and detects the peak times based on a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr</strong> (<em>np.ndarray</em>) – The correlogram array.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The threshold value for peak detection. Defaults to 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The peak indexes for the given correlation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.select_picked_times">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">select_picked_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tend</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#select_picked_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.select_picked_times" title="Link to this definition">¶</a></dt>
<dd><p>Select the picked times within a given time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_tp</strong> (<em>numpy.ndarray</em>) – The time and spatial indexes of the picked times.</p></li>
<li><p><strong>tstart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The starting time of the time range [s].</p></li>
<li><p><strong>tend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The ending time of the time range [s].</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling rate of the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selected picked times within the given time range (time index, spatial index).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.shift_nxcorr">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">shift_nxcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#shift_nxcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.shift_nxcorr" title="Link to this definition">¶</a></dt>
<dd><p>Compute the shifted (positive lags only) normalized cross-correlation with standard deviation normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – first input signal.</p></li>
<li><p><strong>y</strong> (<em>numpy.ndarray</em>) – second input signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalized cross-correlation between the two signals</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.shift_xcorr">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">shift_xcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#shift_xcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.shift_xcorr" title="Link to this definition">¶</a></dt>
<dd><p>compute the shifted (positive lags only) cross correlation between two 1D arrays</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – 1D array containing signal</p></li>
<li><p><strong>y</strong> (<em>numpy.ndarray</em>) – 1D array containing signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D array cross-correlation betweem x and y, only for positive lags</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.xcorr">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">xcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BlueKernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#xcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.xcorr" title="Link to this definition">¶</a></dt>
<dd><p>Cross-correlate kernel with spectrogram</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>np.array</em>) – Vector of times returned from plotwav</p></li>
<li><p><strong>f</strong> (<em>np.array</em>) – Vector of frequencies returned from plotwav</p></li>
<li><p><strong>Sxx</strong> (<em>np.array</em>) – 2-D array of spectrogram amplitudes</p></li>
<li><p><strong>tvec</strong> (<em>np.array</em>) – Vector of times of kernel</p></li>
<li><p><strong>fvec</strong> (<em>np.array</em>) – Vector of frequencies of kernel</p></li>
<li><p><strong>BlueKernel</strong> (<em>np.array</em>) – 2-D array of kernel amplitudes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t_scale</strong> (<em>numpy.array</em>) – Vector of correlation lags</p></li>
<li><p><strong>CorrVal</strong> (<em>numpy.array</em>) – Vector of correlation values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.detect.xcorr2d">
<span class="sig-prename descclassname"><span class="pre">das4whales.detect.</span></span><span class="sig-name descname"><span class="pre">xcorr2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/detect.html#xcorr2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.detect.xcorr2d" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the 2D cross-correlation between a spectrogram and a kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectro</strong> (<em>numpy.ndarray</em>) – The input spectrogram array [frequency x time].</p></li>
<li><p><strong>kernel</strong> (<em>numpy.ndarray</em>) – The kernel array used for cross-correlation [frequency x time].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting cross-correlation array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.dsp">
<span id="das4whales-dsp-module"></span><h2>das4whales.dsp module<a class="headerlink" href="#module-das4whales.dsp" title="Link to this heading">¶</a></h2>
<p>dsp.py - Digital Signal Processing module for DAS4Whales</p>
<p>This module provides various functions for digital signal processing of DAS strain data.</p>
<p>Authors: Léa Bouffaut, Quentin Goestchel
Date: 2023-2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.bp_filt">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">bp_filt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#bp_filt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.bp_filt" title="Link to this definition">¶</a></dt>
<dd><p>bp_filt - perform bandpass filtering on an array of DAS data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – array containing wave signal from DAS data</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – minimum frequency for the passband</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – maximum frequency for the passband</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tr_filt</strong> – bandpass filtered data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.butterworth_filter">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">butterworth_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filterspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#butterworth_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.butterworth_filter" title="Link to this definition">¶</a></dt>
<dd><p>Designs and applies a Butterworth filter.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filterspec<span class="classifier">tuple</span></dt><dd><p>A tuple containing the filter order, critical frequency, and filter type.</p>
</dd>
<dt>fs<span class="classifier">float</span></dt><dd><p>The sampling frequency.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<p>:
filter_sos : np.ndarray</p>
<blockquote>
<div><p>The second-order sections (SOS) representation of the Butterworth filter.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.calc_snr_median">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">calc_snr_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#calc_snr_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.calc_snr_median" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the Signal-to-Noise Ratio (SNR) for a given input trace.</p>
<p>This function computes the SNR for the input trace. The SNR is calculated as the ratio of the square of the envelope of the trace to the square of the median of the trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>np.ndarray</em>) – The input trace for which the SNR is to be calculated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Signal-to-Noise Ratio (SNR) value for the input trace.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.fk_filt">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">fk_filt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#fk_filt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.fk_filt" title="Link to this definition">¶</a></dt>
<dd><p>fk_filt - perform fk filtering on an array of DAS data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – array containing wave signal from DAS data</p></li>
<li><p><strong>tint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – decimation time interval between considered samples</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>xint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – decimation space interval between considered samples</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – spatial resolution</p></li>
<li><p><strong>c_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – minimum phase speed for the pass-band filter in f-k domain</p></li>
<li><p><strong>c_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – maximum phase speed for the pass-band filter in f-k domain</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>array-like</em>) – vector of frequencies</p></li>
<li><p><strong>k</strong> (<em>array-like</em>) – vector of wavenumbers</p></li>
<li><p><strong>g</strong> (<em>array-like</em>) – 2D designed gaussian filter</p></li>
<li><p><strong>data_fft_g</strong> (<em>array-like</em>) – 2D Fourier transformed data, filtered by g</p></li>
<li><p><strong>data_g.real</strong> (<em>array-like</em>) – Real value of spatiotemporal filtered data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.fk_filter_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">fk_filter_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1450</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#fk_filter_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.fk_filter_design" title="Link to this definition">¶</a></dt>
<dd><p>Designs a f-k filter for DAS strain data
Keeps by default data with propagation speed [1450-3400] m/s</p>
<p>The transition band is inspired and adapted from Yi Lin’s matlab fk function
<a class="reference external" href="https://github.com/nicklinyi/seismic_utils/blob/master/fkfilter.m">https://github.com/nicklinyi/seismic_utils/blob/master/fkfilter.m</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – A tuple with the dimensions of the strain data in the spatio-temporal domain such as
trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample].</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list of the selected channels number [start, end, step].</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Channel spacing (m).</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sampling frequency (Hz).</p></li>
<li><p><strong>cs_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum selected sound speeds for the f-k passband filtering (m/s). Default is 1400 m/s.</p></li>
<li><p><strong>cp_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum selected sound speed for the f-k stopband filtering, values should frame [c_min and c_max] (m/s).
Default is 1450 m/s.</p></li>
<li><p><strong>cp_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum selected sound speeds for the f-k passband filtering (m/s). Default is 3400 m/s.</p></li>
<li><p><strong>cs_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum selected sound speed for the f-k stopband filtering, values should frame [c_min and c_max] (m/s).
Default is 3500 m/s.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – A [channel x time sample] numpy array containing the f-k-filter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.fk_filter_design_old">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">fk_filter_design_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1450</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#fk_filter_design_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.fk_filter_design_old" title="Link to this definition">¶</a></dt>
<dd><p>Designs a f-k filter for DAS strain data
Keeps by default data with propagation speed [1450-3400] m/s</p>
<p>The transition band is inspired and adapted from Yi Lin’s matlab fk function
<a class="reference external" href="https://github.com/nicklinyi/seismic_utils/blob/master/fkfilter.m">https://github.com/nicklinyi/seismic_utils/blob/master/fkfilter.m</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – A tuple with the dimensions of the strain data in the spatio-temporal domain such as
trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample].</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list of the selected channels number [start, end, step].</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Channel spacing (m).</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sampling frequency (Hz).</p></li>
<li><p><strong>cs_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum selected sound speeds for the f-k passband filtering (m/s). Default is 1400 m/s.</p></li>
<li><p><strong>cp_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum selected sound speed for the f-k stopband filtering, values should frame [c_min and c_max] (m/s).
Default is 1450 m/s.</p></li>
<li><p><strong>cp_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum selected sound speeds for the f-k passband filtering (m/s). Default is 3400 m/s.</p></li>
<li><p><strong>cs_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum selected sound speed for the f-k stopband filtering, values should frame [c_min and c_max] (m/s).
Default is 3500 m/s.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – A [channel x time sample] numpy array containing the f-k-filter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.1.0: </span>This will be removed in 0.2.0. Use hybrid_filter_design instead</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.fk_filter_filt">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">fk_filter_filt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fk_filter_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#fk_filter_filt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.fk_filter_filt" title="Link to this definition">¶</a></dt>
<dd><p>Applies a pre-calculated f-k filter to DAS strain data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the strain data in the spatio-temporal domain.</p></li>
<li><p><strong>fk_filter_matrix</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the f-k-filter.</p></li>
<li><p><strong>tapering</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag indicating whether to apply tapering to the data. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A [channel x time sample] nparray containing the f-k-filtered strain data in the spatio-temporal domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.fk_filter_sparsefilt">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">fk_filter_sparsefilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fk_filter_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tapering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#fk_filter_sparsefilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.fk_filter_sparsefilt" title="Link to this definition">¶</a></dt>
<dd><p>Applies a pre-calculated f-k filter to DAS strain data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the strain data in the spatio-temporal domain.</p></li>
<li><p><strong>fk_filter_matrix</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the f-k-filter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A [channel x time sample] nparray containing the f-k-filtered strain data in the spatio-temporal domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.get_fx">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">get_fx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#get_fx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.get_fx" title="Link to this definition">¶</a></dt>
<dd><p>Apply a fast Fourier transform (FFT) to each channel of the strain data matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A 2D array of shape (channel, time sample) containing the strain data in the spatio-temporal domain.</p></li>
<li><p><strong>nfft</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of time samples used for the FFT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of shape (channel, freq. sample) containing the strain data in the spatio-spectral domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.get_spectrogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">get_spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#get_spectrogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.get_spectrogram" title="Link to this definition">¶</a></dt>
<dd><p>Get the spectrogram of a single channel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waveform</strong> (<em>np.ndarray</em>) – Single channel temporal signal.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling frequency (Hz).</p></li>
<li><p><strong>nfft</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of time samples used for the STFT. Default is 128.</p></li>
<li><p><strong>overlap_pct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Percentage of overlap in the spectrogram. Default is 0.8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p</strong> (<em>np.ndarray</em>) – Spectrogram in dB scale (normalized by max).</p></li>
<li><p><strong>tt</strong> (<em>np.ndarray</em>) – Time vector.</p></li>
<li><p><strong>ff</strong> (<em>ndarray</em>) – Frequency vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.hybrid_filter_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">hybrid_filter_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1450.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#hybrid_filter_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.hybrid_filter_design" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Designs an infinite wave speed bandpass f-k hybrid filter for DAS strain data</dt><dd><p>Keeps by default data with propagation speed above 1450 m/s between [15 - 25] Hz (designed for fin whales)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple with the dimensions of the strain data in the spatio-temporal domain such as trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample]</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of the selected channels number  [start, end, step]</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – channel spacing (m)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency (Hz)</p></li>
<li><p><strong>cs_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – lower minimum selected sound speeds for the f-k highpass filtering (m/s), by default 1400 m/s</p></li>
<li><p><strong>cp_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – higher minimum selected sound speed for the f-k highpass filtering, by default 1450 m/s</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – minimum frequency for the passband, by default 15</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – maximum frequency for the passband, by default 25</p></li>
<li><p><strong>display_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – option for filter display, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – [channel x time sample] a scipy sparse array containing the f-k-filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.hybrid_gs_filter_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">hybrid_gs_filter_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1450.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#hybrid_gs_filter_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.hybrid_gs_filter_design" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Designs a bandpass f-k hybrid filter for DAS strain data</dt><dd><p>Keeps by default data with propagation speed above 1450 m/s between [15 - 25] Hz (designed for fin whales)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple with the dimensions of the strain data in the spatio-temporal domain such as trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample]</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of the selected channels number  [start, end, step]</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – channel spacing (m)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency (Hz)</p></li>
<li><p><strong>cs_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – lower minimum selected sound speeds for the f-k highpass filtering (m/s), by default 1400 m/s</p></li>
<li><p><strong>cp_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – higher minimum selected sound speed for the f-k highpass filtering, by default 1450 m/s</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – minimum frequency for the passband, by default 15</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – maximum frequency for the passband, by default 25</p></li>
<li><p><strong>display_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – option for filter display, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – [channel x time sample] a scipy sparse array containing the f-k-filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.hybrid_ninf_filter_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">hybrid_ninf_filter_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1450.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#hybrid_ninf_filter_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.hybrid_ninf_filter_design" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Designs a bandpass f-k hybrid filter for DAS strain data</dt><dd><p>Keeps by default data with propagation speed above 1450 m/s between [15 - 25] Hz (designed for fin whales)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple with the dimensions of the strain data in the spatio-temporal domain such as trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample]</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of the selected channels number  [start, end, step]</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – channel spacing (m)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency (Hz)</p></li>
<li><p><strong>cs_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – lower minimum selected sound speeds for the f-k highpass filtering (m/s), by default 1400 m/s</p></li>
<li><p><strong>cp_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – higher minimum selected sound speed for the f-k highpass filtering, by default 1450 m/s</p></li>
<li><p><strong>fmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – minimum frequency for the passband, by default 15</p></li>
<li><p><strong>fmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – maximum frequency for the passband, by default 25</p></li>
<li><p><strong>display_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – option for filter display, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – [channel x time sample] a scipy sparse array containing the f-k-filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.hybrid_ninf_gs_filter_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">hybrid_ninf_gs_filter_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fk_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#hybrid_ninf_gs_filter_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.hybrid_ninf_gs_filter_design" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Designs a bandpass f-k hybrid filter for DAS strain data</dt><dd><p>Keeps by default data with propagation speed above 1450 m/s between [15 - 25] Hz (designed for fin whales)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple with the dimensions of the strain data in the spatio-temporal domain such as trace_shape = (trace.shape[0], trace.shape[1]) where dimensions are [channel x time sample]</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of the selected channels number  [start, end, step]</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – channel spacing (m)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency (Hz)</p></li>
<li><p><strong>fk_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – dictionary containing the parameters for the f-k filter design</p></li>
<li><p><strong>display_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – option for filter display, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fk_filter_matrix</strong> – [channel x time sample] a scipy sparse array containing the f-k-filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.instant_freq">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">instant_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#instant_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.instant_freq" title="Link to this definition">¶</a></dt>
<dd><p>Compute the instantaneous frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel</strong> (<em>np.ndarray</em>) – 1D time series channel trace</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instantaneous frequency along time[1:]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.moving_average">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">moving_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#moving_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.moving_average" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.moving_average_matrix">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">moving_average_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#moving_average_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.moving_average_matrix" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.normalize_median">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">normalize_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#normalize_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.normalize_median" title="Link to this definition">¶</a></dt>
<dd><p>Normalize the input trace by its median.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>np.ndarray</em>) – A 2D array of shape (channel, time sample) containing the strain data in the spatio-temporal domain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of shape (channel, time sample) containing the normalized strain data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.normalize_std">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">normalize_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#normalize_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.normalize_std" title="Link to this definition">¶</a></dt>
<dd><p>Normalize the input trace by its standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>np.ndarray</em>) – A 2D array of shape (channel, time sample) containing the strain data in the spatio-temporal domain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of shape (channel, time sample) containing the normalized strain data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.snr_tr_array">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">snr_tr_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#snr_tr_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.snr_tr_array" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the 2D Signal-to-Noise Ratio (SNR) array for a given input trace.</p>
<p>This function computes the SNR for each element in the input 2D trace array. The SNR
is calculated as the ratio of the square of the trace values to the square of the
standard deviation of the trace along the second axis (time).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>numpy.ndarray</em>) – The input 2D trace array for which the SNR is to be calculated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array containing the Signal-to-Noise Ratio (SNR) values for each element
in the input trace.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.taper_data">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">taper_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#taper_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.taper_data" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Tukey window to each line (time series) of the input matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>np.ndarray</em>) – 2D numpy array, where each column represents a time series.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tapered matrix with the same shape as the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.dsp.taper_data2d">
<span class="sig-prename descclassname"><span class="pre">das4whales.dsp.</span></span><span class="sig-name descname"><span class="pre">taper_data2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tukey'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/dsp.html#taper_data2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.dsp.taper_data2d" title="Link to this definition">¶</a></dt>
<dd><p>Applies tapering (windowing) to the data in both space (channels) and time (samples) domains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – 2D numpy array representing the spatio-temporal data with dimensions [channels x samples].</p></li>
<li><p><strong>taper_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Type of tapering window to apply. Options are ‘hanning’, ‘hamming’, or ‘tukey’. Default is ‘tukey’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tapered_data</strong> – The tapered data array with the same shape as input data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.improcess">
<span id="das4whales-improcess-module"></span><h2>das4whales.improcess module<a class="headerlink" href="#module-das4whales.improcess" title="Link to this heading">¶</a></h2>
<p>improcess.py - image processing functions for DAS data</p>
<p>This module contains functions for image processing of DAS data.</p>
<p>Authors: Quentin Goestchel
Date: 2023-2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.angle_fromspeed">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">angle_fromspeed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#angle_fromspeed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.angle_fromspeed" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the angle from the speed of sound.</p>
<p>This function calculates the angle from the speed of sound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The speed of sound.</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling frequency.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The spatial resolution.</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of the selected channels number  [start, end, step].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The angle from the speed of sound.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.apply_median_filter_chunk">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">apply_median_filter_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_chunk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#apply_median_filter_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.apply_median_filter_chunk" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.apply_smooth_mask">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">apply_smooth_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#apply_smooth_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.apply_smooth_mask" title="Link to this definition">¶</a></dt>
<dd><p>Apply a smooth mask to an array.</p>
<p>This function applies a smooth mask to an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.ndarray</em>) – The input array.</p></li>
<li><p><strong>mask</strong> (<em>numpy.ndarray</em>) – The mask to apply.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em><em> (</em><em>default=1.5</em><em>)</em>) – The standard deviation of the Gaussian filter applied to the mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The masked array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.bilateral_filter">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">bilateral_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#bilateral_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.bilateral_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply bilateral filter to an image.</p>
<p>This function applies bilateral filter to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>diameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Diameter of each pixel neighborhood that is used during filtering.</p></li>
<li><p><strong>sigma_color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Filter sigma in the color space.</p></li>
<li><p><strong>sigma_space</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Filter sigma in the coordinate space.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.binning">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#binning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.binning" title="Link to this definition">¶</a></dt>
<dd><p>Apply binning to an image.</p>
<p>This function applies binning to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>ft</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The binning factor along the time axis.</p></li>
<li><p><strong>fx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The binning factor along the spatial axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The binned image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.compute_radon_transform">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">compute_radon_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#compute_radon_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.compute_radon_transform" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Radon transform of an image.</p>
<p>This function computes the Radon transform of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>theta</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – The projection angles (in degrees).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Radon transform of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.detect_diagonal_edges">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">detect_diagonal_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#detect_diagonal_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.detect_diagonal_edges" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.detect_long_lines">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">detect_long_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#detect_long_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.detect_long_lines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.diagonal_edge_detection">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">diagonal_edge_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#diagonal_edge_detection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.diagonal_edge_detection" title="Link to this definition">¶</a></dt>
<dd><p>Detect diagonal edges in an image.
Inspired from <a class="reference external" href="https://github.com/Ocean-Data-Lab/das-finwhale-vocalization/">https://github.com/Ocean-Data-Lab/das-finwhale-vocalization/</a></p>
<p>This function detects diagonal edges in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The threshold value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The diagonal edges in the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.gabor_filt_design">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">gabor_filt_design</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#gabor_filt_design"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.gabor_filt_design" title="Link to this definition">¶</a></dt>
<dd><p>Design Gabor filters for lines that are oriented along sound speed.</p>
<p>This function designs Gabor filters for lines that are oriented along sound speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta_c0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The angle from the speed of sound.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Gabor filters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.gaussian_filter">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply Gaussian filter to an image.</p>
<p>This function applies Gaussian filter to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The size of the filter.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The standard deviation of the filter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.gradient_oriented">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">gradient_oriented</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#gradient_oriented"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.gradient_oriented" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the gradient oriented value of an image.</p>
<p>This function calculates the gradient oriented value of an image based on the given direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>direction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – A tuple containing the direction values (dft, dfx).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gradient oriented value of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.par_medfilt">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">par_medfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#par_medfilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.par_medfilt" title="Link to this definition">¶</a></dt>
<dd><p>Apply median filter to an array in parallel.</p>
<p>This function applies median filter to an array in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.ndarray</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The size of the filter.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>default=-1</em><em>)</em>) – The number of jobs to run in parallel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.scale_pixels">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">scale_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#scale_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.scale_pixels" title="Link to this definition">¶</a></dt>
<dd><p>Scale the pixel values of an image.</p>
<p>This function scales the pixel values of an image to the range [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy.ndarray</em>) – The input image.</p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em><em> (</em><em>default=1</em><em>)</em>) – The scaling factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scaled image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.improcess.trace2image">
<span class="sig-prename descclassname"><span class="pre">das4whales.improcess.</span></span><span class="sig-name descname"><span class="pre">trace2image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/improcess.html#trace2image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.improcess.trace2image" title="Link to this definition">¶</a></dt>
<dd><p>Convert a DAS trace to an image.</p>
<p>This function converts a DAS trace matrix to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trace</strong> (<em>numpy.ndarray</em>) – The input trace.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.loc">
<span id="das4whales-loc-module"></span><h2>das4whales.loc module<a class="headerlink" href="#module-das4whales.loc" title="Link to this heading">¶</a></h2>
<p>loc.py - Localisation module for the das4whales package.</p>
<p>This module provides functions for localizing the source of a sound source recorded by a DAS array.</p>
<p>Author: Quentin Goestchel
Date: 2024-06-18</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.cal_variance_residuals">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">cal_variance_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrtimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predic_arrtimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#cal_variance_residuals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.cal_variance_residuals" title="Link to this definition">¶</a></dt>
<dd><p>Compute the variance of the residuals of the arrival times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrtimes</strong> (<em>np.ndarray</em>) – array of measured arrival times</p></li>
<li><p><strong>predic_arrtimes</strong> (<em>np.ndarray</em>) – array of predicted arrival times</p></li>
<li><p><strong>fix_z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – True if the z coordinate is fixed, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>var</strong> – Variance of the residuals</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_arrival_times">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_arrival_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_arrival_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_arrival_times" title="Link to this definition">¶</a></dt>
<dd><p>Get the theoretical arrival times of a whale call at a given distance along the cable</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_covariance_matrix">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_covariance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_covariance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_covariance_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix of the estimated whale position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cable_pos</strong> (<em>np.ndarray</em>) – Array of cable positions [channel x 3]</p></li>
<li><p><strong>whale_pos</strong> (<em>np.ndarray</em>) – Estimated whale position [x, y, z, t0]</p></li>
<li><p><strong>c0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Speed of sound in water considered constant</p></li>
<li><p><strong>var</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Variance of the residuals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cov</strong> – Covariance matrix of the estimated whale position</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_distance_matrix">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_distance_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Compute the distance matrix between the cable and the whale</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_phi_vector">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_phi_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_phi_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_phi_vector" title="Link to this definition">¶</a></dt>
<dd><p>Compute the azimuthal angle between the cable and the whale for each cable position</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_radii_matrix">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_radii_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_radii_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_radii_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Compute the radii matrix between the cable and the whale</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_theta_vector">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_theta_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_theta_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_theta_vector" title="Link to this definition">¶</a></dt>
<dd><p>Compute the elevation angle between the cable and the whale for each cable position</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.calc_uncertainty_position">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">calc_uncertainty_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whale_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#calc_uncertainty_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.calc_uncertainty_position" title="Link to this definition">¶</a></dt>
<dd><p>Compute the uncertainties on the estimated whale position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cable_pos</strong> (<em>np.ndarray</em>) – Array of cable positions [channel x 3]</p></li>
<li><p><strong>whale_pos</strong> (<em>np.ndarray</em>) – Estimated whale position [x, y, z, t0]</p></li>
<li><p><strong>c0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Speed of sound in water considered constant</p></li>
<li><p><strong>var</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Variance of the residuals</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>unc</strong> – Uncertainties on the estimated whale position</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.loc.solve_lq">
<span class="sig-prename descclassname"><span class="pre">das4whales.loc.</span></span><span class="sig-name descname"><span class="pre">solve_lq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ti</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cable_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nbiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ninit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/loc.html#solve_lq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.loc.solve_lq" title="Link to this definition">¶</a></dt>
<dd><p>Solve the least squares problem to localize the whale</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ti</strong> (<em>np.ndarray</em>) – Array of arrival times at each cable position [channel x 1]</p></li>
<li><p><strong>cable_pos</strong> (<em>np.ndarray</em>) – Array of cable positions [channel x 3]</p></li>
<li><p><strong>c0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Speed of sound in water considered constant</p></li>
<li><p><strong>Nbiter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em><em> (</em><em>default=10</em><em>)</em>) – Number of iterations for the least squares algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n</strong> – Estimated whale position and time of emission vector [x, y, z, t0]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.map">
<span id="das4whales-map-module"></span><h2>das4whales.map module<a class="headerlink" href="#module-das4whales.map" title="Link to this heading">¶</a></h2>
<p>map.py - Map creation module for the das4whales package.</p>
<p>This module provides functions for coordinates handling and map visualization for DAS data.</p>
<p>Author: Quentin Goestchel
Date: 2024-06-26</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.flatten_bathy">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">flatten_bathy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#flatten_bathy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.flatten_bathy" title="Link to this definition">¶</a></dt>
<dd><p>Flatten the bathymetry above a certain threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The threshold above which the bathymetry is flattened.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bathy_flat</strong> – The flattened bathymetry data array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.latlon_to_utm">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">latlon_to_utm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#latlon_to_utm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.latlon_to_utm" title="Link to this definition">¶</a></dt>
<dd><p>Convert latitude and longitude to UTM coordinates for a specified zone</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The longitude.</p></li>
<li><p><strong>lat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The latitude.</p></li>
<li><p><strong>zone</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The UTM zone.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>utm_x</strong> (<em>float</em>) – The UTM x coordinate.</p></li>
<li><p><strong>utm_y</strong> (<em>float</em>) – The UTM y coordinate.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.load_bathymetry">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">load_bathymetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#load_bathymetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.load_bathymetry" title="Link to this definition">¶</a></dt>
<dd><p>Load the bathymetry data from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The file path to the bathymetry data file. ‘.grd’ file format is used here and can be found at <a class="reference external" href="https://www.gmrt.org/GMRTMapTool/">https://www.gmrt.org/GMRTMapTool/</a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>xlon</strong> (<em>np.ndarray</em>) – The longitude data vector.</p></li>
<li><p><strong>ylat</strong> (<em>np.ndarray</em>) – The latitude data vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.load_cable_coordinates">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">load_cable_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#load_cable_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.load_cable_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Load the cable coordinates from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The file path to the cable coordinates file.</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The distance between two channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – The cable coordinates dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.plot_cables2D">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">plot_cables2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_north</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_south</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#plot_cables2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.plot_cables2D" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cables on the bathymetry map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_north</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the north cable coordinates.</p></li>
<li><p><strong>df_south</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the south cable coordinates.</p></li>
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>xlon</strong> (<em>np.ndarray</em>) – The longitude data vector.</p></li>
<li><p><strong>ylat</strong> (<em>np.ndarray</em>) – The latitude data vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.plot_cables2D_m">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">plot_cables2D_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_north</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_south</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#plot_cables2D_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.plot_cables2D_m" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cables on the bathymetry map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_north</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the north cable coordinates.</p></li>
<li><p><strong>df_south</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the south cable coordinates.</p></li>
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>xm</strong> (<em>np.ndarray</em>) – The x data vector in meters.</p></li>
<li><p><strong>ym</strong> (<em>np.ndarray</em>) – The y data vector in meters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.plot_cables3D">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">plot_cables3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_north</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_south</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#plot_cables3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.plot_cables3D" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cables on the bathymetry map in 3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_north</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the north cable coordinates.</p></li>
<li><p><strong>df_south</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the south cable coordinates.</p></li>
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>xlon</strong> (<em>np.ndarray</em>) – The longitude data vector.</p></li>
<li><p><strong>ylat</strong> (<em>np.ndarray</em>) – The latitude data vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.map.plot_cables3D_m">
<span class="sig-prename descclassname"><span class="pre">das4whales.map.</span></span><span class="sig-name descname"><span class="pre">plot_cables3D_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_north</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_south</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/map.html#plot_cables3D_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.map.plot_cables3D_m" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cables on the bathymetry map in 3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_north</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the north cable coordinates.</p></li>
<li><p><strong>df_south</strong> (<em>pandas.DataFrame</em>) – The dataframe containing the south cable coordinates in meters.</p></li>
<li><p><strong>bathy</strong> (<em>np.ndarray</em>) – The bathymetry data array. zij = bathy[i,j] is the depth at the point (xlon[j], ylat[i]).</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The x data vector.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – The y data vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.plot">
<span id="das4whales-plot-module"></span><h2>das4whales.plot module<a class="headerlink" href="#module-das4whales.plot" title="Link to this heading">¶</a></h2>
<p>plot.py - Plotting module for DAS4Whales</p>
<p>This module provides functions for plotting das data and data products in various formats.</p>
<p>Authors: Léa Bouffaut, Quentin Goestchel
Date: 2023-2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.design_mf">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">design_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnote</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnote</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#design_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.design_mf" title="Link to this definition">¶</a></dt>
<dd><p>Plot to design the matched filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.ndarray</em>) – 1D time series channel trace</p></li>
<li><p><strong>hnote</strong> (<em>numpy.ndarray</em>) – 1D time series high frequency note template</p></li>
<li><p><strong>lnote</strong> (<em>numpy.ndarray</em>) – 1D time series low frequency note template</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – start time of the high frequency note</p></li>
<li><p><strong>tl</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – start time of the low frequency note</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – 1D vector of time values</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.detection_grad">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">detection_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#detection_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.detection_grad" title="Link to this definition">¶</a></dt>
<dd><p>Plot the strain trace matrix [dist x time] with call detection above it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.ndarray</em>) – [channel x time sample] array containing the strain data in the spatio-temporal domain</p></li>
<li><p><strong>peaks_idx_HF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the high frequency call</p></li>
<li><p><strong>peaks_idx_LF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the low frequency call</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – time vector</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – distance vector along the cable</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – spatial step</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of selected channels indexes [start, stop, step]</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – time stamp of file, by default 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.detection_mf">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">detection_mf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_idx_HF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_idx_LF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#detection_mf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.detection_mf" title="Link to this definition">¶</a></dt>
<dd><p>Plot the strain trace matrix [dist x time] with call detection above it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.ndarray</em>) – [channel x time sample] array containing the strain data in the spatio-temporal domain</p></li>
<li><p><strong>peaks_idx_HF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the high frequency call</p></li>
<li><p><strong>peaks_idx_LF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the low frequency call</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – time vector</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – distance vector along the cable</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – spatial step</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of selected channels indexes [start, stop, step]</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – time stamp of file, by default 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.detection_spectcorr">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">detection_spectcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_idx_HF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_idx_LF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectro_fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#detection_spectcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.detection_spectcorr" title="Link to this definition">¶</a></dt>
<dd><p>Plot the strain trace matrix [dist x time] with call detection above it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.ndarray</em>) – [channel x time sample] array containing the strain data in the spatio-temporal domain</p></li>
<li><p><strong>peaks_idx_HF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the high frequency call</p></li>
<li><p><strong>peaks_idx_LF</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – tuple of lists containing the detected call indexes coordinates (first list: channel idx, second list: time idx) for the low frequency call</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – time vector</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – distance vector along the cable</p></li>
<li><p><strong>spectro_fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency of the spectrograms</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – spatial step</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of selected channels indexes [start, stop, step]</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – time stamp of file, by default 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.import_parula">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">import_parula</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#import_parula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.import_parula" title="Link to this definition">¶</a></dt>
<dd><p>Import the colormap parula from matlab</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>colormap</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ListedColormap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.import_roseus">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">import_roseus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#import_roseus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.import_roseus" title="Link to this definition">¶</a></dt>
<dd><p>Import the colormap from the colormap/roseus_matplotlib.py file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>colormap</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ListedColormap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_3calls">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_3calls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_3calls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_3calls" title="Link to this definition">¶</a></dt>
<dd><p>Plot the strain channel with 3 calls highlighted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel</strong> (<em>np.ndarray</em>) – The strain channel.</p></li>
<li><p><strong>time</strong> (<em>np.ndarray</em>) – The time values.</p></li>
<li><p><strong>t1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The time of the first call.</p></li>
<li><p><strong>t2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The time of the second call.</p></li>
<li><p><strong>t3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The time of the third call.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_cross_correlogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_cross_correlogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_cross_correlogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_cross_correlogram" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cross-correlogram between HF and LF notes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_m</strong> (<em>numpy.ndarray</em>) – The cross-correlation matrix</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – The time values.</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – The distance values.</p></li>
<li><p><strong>maxv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The maximum value for the colorbar.</p></li>
<li><p><strong>minv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum value for the colorbar. Default is 0.</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.13)"><em>datetime.datetime</em></a><em>, </em><em>optional</em>) – The beginning time of the file in UTC. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_cross_correlogramHL">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_cross_correlogramHL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_m_HF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_m_LF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_cross_correlogramHL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_cross_correlogramHL" title="Link to this definition">¶</a></dt>
<dd><p>Plot the cross-correlogram between HF and LF notes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_m_HF</strong> (<em>numpy.ndarray</em>) – The cross-correlation matrix of the HF notes.</p></li>
<li><p><strong>corr_m_LF</strong> (<em>numpy.ndarray</em>) – The cross-correlation matrix of the LF notes.</p></li>
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – The time values.</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – The distance values.</p></li>
<li><p><strong>maxv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The maximum value for the colorbar.</p></li>
<li><p><strong>minv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum value for the colorbar. Default is 0.</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.13)"><em>datetime.datetime</em></a><em>, </em><em>optional</em>) – The beginning time of the file in UTC. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_fk_domain">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_fk_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fk_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_fk_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_fk_domain" title="Link to this definition">¶</a></dt>
<dd><p>Spatio-spectral representation (f-k plot) of the strain data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling frequency (Hz)</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The spatial step (m)</p></li>
<li><p><strong>selected_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of selected channels indexes [start, stop, step]</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.13)"><em>datetime.datetime</em></a><em>, </em><em>optional</em>) – The time stamp of the represented file, by default 0</p></li>
<li><p><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Tuple of the figure dimensions, by default (12, 10)</p></li>
<li><p><strong>v_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Sets the min nano strain amplitudes of the colorbar, by default None</p></li>
<li><p><strong>v_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Sets the max nano strain amplitudes of the colorbar, by default None</p></li>
<li><p><strong>fk_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary containing the fmin, fmax, c_min, and c_max parameters, by default None</p></li>
<li><p><strong>ax_lims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of the form [f_min, f_max, k_min, k_max] for zoomed plots, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function plots the spatio-spectral representation (f-k plot) of the strain data.</p>
<ul class="simple">
<li><p>The frequency axis is created using the FFT.</p></li>
<li><p>The strain data is processed and plotted.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_fk_domain</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">file_begin_time_utc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">v_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_fx">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_fx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_fx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_fx" title="Link to this definition">¶</a></dt>
<dd><p>Spatio-spectral (f-k plot) of the strain data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>np.ndarray</em>) – A [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p></li>
<li><p><strong>dist</strong> (<em>np.ndarray</em>) – The corresponding distance along the FO cable vector</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The sampling frequency (Hz)</p></li>
<li><p><strong>file_begin_time_utc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.13)"><em>datetime.datetime</em></a><em>, </em><em>optional</em>) – The time stamp of the represented file, by default 0</p></li>
<li><p><strong>win_s</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The duration of each f-k plot (s), by default 2</p></li>
<li><p><strong>nfft</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of time samples used for the FFT, by default 4096</p></li>
<li><p><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Tuple of the figure dimensions, by default (12, 10)</p></li>
<li><p><strong>f_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Displayed minimum frequency interval (Hz), by default 0</p></li>
<li><p><strong>f_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Displayed maximum frequency interval (Hz), by default 100</p></li>
<li><p><strong>v_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Set the min nano strain amplitudes of the colorbar, by default None</p></li>
<li><p><strong>v_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Set the max nano strain amplitudes of the colorbar, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function plots the spatio-spectral (f-k plot) of the strain data.</p>
<ul class="simple">
<li><p>The number of subplots is evaluated based on the duration of each f-k plot.</p></li>
<li><p>The frequency axis is created using the FFT.</p></li>
<li><p>The strain data is processed and plotted for each subplot.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_fx</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">file_begin_time_utc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">win_s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="go">            f_max=100, v_min=None, v_max=None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_rawdata">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_rawdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_rawdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_rawdata" title="Link to this definition">¶</a></dt>
<dd><p>Plot the raw DAS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>ndarray</em>) – The DAS trace data.</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – The time values corresponding to the trace data.</p></li>
<li><p><strong>dist</strong> (<em>ndarray</em>) – The distance values corresponding to the trace data.</p></li>
<li><p><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – The size of the figure in inches, by default (12, 10).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_spectrogram">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(17,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_spectrogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_spectrogram" title="Link to this definition">¶</a></dt>
<dd><p>Plot a spectrogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>ndarray</em>) – Spectrogram values in dB.</p></li>
<li><p><strong>tt</strong> (<em>ndarray</em>) – Associated time vector (s).</p></li>
<li><p><strong>ff</strong> (<em>ndarray</em>) – Associated frequency vector (Hz).</p></li>
<li><p><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em>) – Tuple of the figure dimensions. Default is (17, 5).</p></li>
<li><p><strong>v_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum dB strain amplitudes of the colorbar.</p></li>
<li><p><strong>v_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum dB strain amplitudes of the colorbar.</p></li>
<li><p><strong>f_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum frequency for the spectrogram display.</p></li>
<li><p><strong>f_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum frequency for the spectrogram display.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_tx">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_tx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Strain</span> <span class="pre">Envelope</span> <span class="pre">(x$10^{-9}$)'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_tx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_tx" title="Link to this definition">¶</a></dt>
<dd><p>Spatio-temporal representation (t-x plot) of the strain data</p>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>trace<span class="classifier">np.ndarray</span></dt><dd><p>A [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p>
</dd>
<dt>time<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding time vector</p>
</dd>
<dt>dist<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding distance along the FO cable vector</p>
</dd>
<dt>file_begin_time_utc<span class="classifier">int or datetime.datetime, optional</span></dt><dd><p>The time stamp of the represented file (default is 0)</p>
</dd>
<dt>fig_size<span class="classifier">tuple, optional</span></dt><dd><p>Tuple of the figure dimensions (default is (12, 10))</p>
</dd>
<dt>v_min<span class="classifier">float, optional</span></dt><dd><p>Sets the min nano strain amplitudes of the colorbar (default is None)</p>
</dd>
<dt>v_max<span class="classifier">float, optional</span></dt><dd><p>Sets the max nano strain amplitudes of the colorbar (default is None)</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>:
None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_tx_env">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_tx_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Strain</span> <span class="pre">Envelope</span> <span class="pre">(x$10^{-9}$)'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_tx_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_tx_env" title="Link to this definition">¶</a></dt>
<dd><p>Spatio-temporal representation (t-x plot) of the strain data envelope</p>
<section id="id3">
<h3>Parameters:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>trace<span class="classifier">np.ndarray</span></dt><dd><p>A [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p>
</dd>
<dt>time<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding time vector</p>
</dd>
<dt>dist<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding distance along the FO cable vector</p>
</dd>
<dt>file_begin_time_utc<span class="classifier">int or datetime.datetime, optional</span></dt><dd><p>The time stamp of the represented file (default is 0)</p>
</dd>
<dt>fig_size<span class="classifier">tuple, optional</span></dt><dd><p>Tuple of the figure dimensions (default is (12, 10))</p>
</dd>
<dt>v_min<span class="classifier">float, optional</span></dt><dd><p>Sets the min nano strain amplitudes of the colorbar (default is None)</p>
</dd>
<dt>v_max<span class="classifier">float, optional</span></dt><dd><p>Sets the max nano strain amplitudes of the colorbar (default is None)</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>:
None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.plot_tx_lined">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">plot_tx_lined</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#plot_tx_lined"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.plot_tx_lined" title="Link to this definition">¶</a></dt>
<dd><p>Spatio-temporal representation (t-x plot) of the strain data</p>
<section id="id5">
<h3>Parameters:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>trace<span class="classifier">np.ndarray</span></dt><dd><p>A [channel x time sample] nparray containing the strain data in the spatio-temporal domain</p>
</dd>
<dt>ln_idx<span class="classifier">int</span></dt><dd><p>The index of the line to be plotted</p>
</dd>
<dt>time<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding time vector</p>
</dd>
<dt>dist<span class="classifier">np.ndarray</span></dt><dd><p>The corresponding distance along the FO cable vector</p>
</dd>
<dt>file_begin_time_utc<span class="classifier">int or datetime.datetime, optional</span></dt><dd><p>The time stamp of the represented file (default is 0)</p>
</dd>
<dt>fig_size<span class="classifier">tuple, optional</span></dt><dd><p>Tuple of the figure dimensions (default is (12, 10))</p>
</dd>
<dt>v_min<span class="classifier">float, optional</span></dt><dd><p>Sets the min nano strain amplitudes of the colorbar (default is None)</p>
</dd>
<dt>v_max<span class="classifier">float, optional</span></dt><dd><p>Sets the max nano strain amplitudes of the colorbar (default is None)</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>:
None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.plot.snr_matrix">
<span class="sig-prename descclassname"><span class="pre">das4whales.plot.</span></span><span class="sig-name descname"><span class="pre">snr_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snr_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_begin_time_utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/plot.html#snr_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.plot.snr_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Matrix plot of the local signal to noise ratio (SNR)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snr_m</strong> (<em>numpy.ndarray</em>) – [channel x time sample] array containing the SNR in the spatio-temporal domain</p></li>
<li><p><strong>time</strong> (<em>nummpy.ndarray</em>) – time vector</p></li>
<li><p><strong>dist</strong> (<em>numpy.ndarray</em>) – distance vector along the cable</p></li>
<li><p><strong>vmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – maximun value of the plot (dB)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-das4whales.tools">
<span id="das4whales-tools-module"></span><h2>das4whales.tools module<a class="headerlink" href="#module-das4whales.tools" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.disp_comprate">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">disp_comprate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fk_filter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#disp_comprate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.disp_comprate" title="Link to this definition">¶</a></dt>
<dd><p>Display the sizes of the f-k filter matrix (sparse and dense version) and print the compression ratio</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fk_filter</strong> (<em>sparse.COO</em>) – f-k filter sparse matrix designed by function dsp.hybrid_filter_design()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.energy_TimeDomain">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">energy_TimeDomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#energy_TimeDomain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.energy_TimeDomain" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>energy_TimeDomain - calculate energy in time domain using parsevals theorem</dt><dd><p>energy is calculated for each chunk in time_dim</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xr.DataArray</em>) – DataArray containing DAS data</p></li>
<li><p><strong>time_dim</strong> (<em>string</em>) – time dimension of da</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>da_energy</strong> – DataArray containing energy in time domain. Units are V^2 (where V is units of da)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.filtfilt">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">filtfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#filtfilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.filtfilt" title="Link to this definition">¶</a></dt>
<dd><p>filtfilt - this is an implentation of [scipy.signal.fitlfilt](<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html</a>)
This will filter the DAS data in time for each chunk. This process maps chunks and will therefore have error at the end of chunks in time.</p>
<p>By default, this does not compute, but generates the task graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xr.DataArray</em>) – DataArray containing DAS data that you want to filter.</p></li>
<li><p><strong>dim</strong> (<em>string</em>) – dimension to filter in (should be dimension in da)</p></li>
<li><p><strong>**kwargs</strong> (<em>various types</em>) – passed to [scipy.signal.filtfilt](<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html</a>)
as per docs, [‘x’, ‘b’, and ‘a’] are required</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>da_filt</strong> – filtered data array in time. This does not compute the result, but just the task map in dask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.filtfilt_chunk">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">filtfilt_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#filtfilt_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.filtfilt_chunk" title="Link to this definition">¶</a></dt>
<dd><p>converts dataarray to numpy, sends it to signal.filtfilt and then reinhereits all coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da</strong> (<em>xr.DataArray</em>)</p></li>
<li><p><strong>dim</strong> (<em>string</em>) – dimension to filter over (should be dimension in da)</p></li>
<li><p><strong>**kwargs</strong> (<em>various types</em>) – passed to scipy.signal.filtfilt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.fk_filt">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">fk_filt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#fk_filt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.fk_filt" title="Link to this definition">¶</a></dt>
<dd><p>fk_filt - perform fk filtering on DAS data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.DataArray</em>) – DataArray containing DAS data</p></li>
<li><p><strong>tint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – interval in time between samples</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>xint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – interval in space between samples</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – distance between samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.fk_filt_chunk">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">fk_filt_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#fk_filt_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.fk_filt_chunk" title="Link to this definition">¶</a></dt>
<dd><p>fk_filt_chunk - perform fk filtering on single chunk of DAS data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.DataArray</em>) – DataArray containing single chunk</p></li>
<li><p><strong>tint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – interval in time between samples</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling frequency</p></li>
<li><p><strong>xint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – interval in space between samples</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – distance between samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="das4whales.tools.spec">
<span class="sig-prename descclassname"><span class="pre">das4whales.tools.</span></span><span class="sig-name descname"><span class="pre">spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/das4whales/tools.html#spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#das4whales.tools.spec" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>very quick implementation to calculate spectrogram</dt><dd><p>PSD is calculated for every chunk</p>
</dd>
</dl>
<p>Currently hardcoded for chunk size of 3000 in time
:type da: 
:param da: das data to compute spectrogram for
:type da: xr.DataArray</p>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../src/data_handle.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">data_handle</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../src/tutorial.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Bouffaut &amp; Goestchel
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">das4whales package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-das4whales.dask_wrap">das4whales.dask_wrap module</a><ul>
<li><a class="reference internal" href="#das4whales.dask_wrap.load_das_data"><code class="docutils literal notranslate"><span class="pre">load_das_data()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dask_wrap.raw2strain"><code class="docutils literal notranslate"><span class="pre">raw2strain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.data_handle">das4whales.data_handle module</a><ul>
<li><a class="reference internal" href="#das4whales.data_handle.calc_dist_to_xidx"><code class="docutils literal notranslate"><span class="pre">calc_dist_to_xidx()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.dl_file"><code class="docutils literal notranslate"><span class="pre">dl_file()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.get_acquisition_parameters"><code class="docutils literal notranslate"><span class="pre">get_acquisition_parameters()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.get_metadata_onyx"><code class="docutils literal notranslate"><span class="pre">get_metadata_onyx()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.get_metadata_optasense"><code class="docutils literal notranslate"><span class="pre">get_metadata_optasense()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.get_metadata_silixa"><code class="docutils literal notranslate"><span class="pre">get_metadata_silixa()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.get_selected_channels"><code class="docutils literal notranslate"><span class="pre">get_selected_channels()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.hello_world_das_package"><code class="docutils literal notranslate"><span class="pre">hello_world_das_package()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.load_cable_coordinates"><code class="docutils literal notranslate"><span class="pre">load_cable_coordinates()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.load_das_data"><code class="docutils literal notranslate"><span class="pre">load_das_data()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.load_mtpl_das_data"><code class="docutils literal notranslate"><span class="pre">load_mtpl_das_data()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.data_handle.raw2strain"><code class="docutils literal notranslate"><span class="pre">raw2strain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.detect">das4whales.detect module</a><ul>
<li><a class="reference internal" href="#das4whales.detect.buildkernel"><code class="docutils literal notranslate"><span class="pre">buildkernel()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.buildkernel_from_template"><code class="docutils literal notranslate"><span class="pre">buildkernel_from_template()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.calc_nmf"><code class="docutils literal notranslate"><span class="pre">calc_nmf()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.calc_nmf_correlogram"><code class="docutils literal notranslate"><span class="pre">calc_nmf_correlogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.compute_cross_correlogram"><code class="docutils literal notranslate"><span class="pre">compute_cross_correlogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.compute_cross_correlogram_spectrocorr"><code class="docutils literal notranslate"><span class="pre">compute_cross_correlogram_spectrocorr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.convert_pick_times"><code class="docutils literal notranslate"><span class="pre">convert_pick_times()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.gen_hyperbolic_chirp"><code class="docutils literal notranslate"><span class="pre">gen_hyperbolic_chirp()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.gen_linear_chirp"><code class="docutils literal notranslate"><span class="pre">gen_linear_chirp()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.gen_template_fincall"><code class="docutils literal notranslate"><span class="pre">gen_template_fincall()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.get_sliced_nspectrogram"><code class="docutils literal notranslate"><span class="pre">get_sliced_nspectrogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.nxcorr2d"><code class="docutils literal notranslate"><span class="pre">nxcorr2d()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.pick_times"><code class="docutils literal notranslate"><span class="pre">pick_times()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.pick_times_env"><code class="docutils literal notranslate"><span class="pre">pick_times_env()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.pick_times_par"><code class="docutils literal notranslate"><span class="pre">pick_times_par()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.process_corr"><code class="docutils literal notranslate"><span class="pre">process_corr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.select_picked_times"><code class="docutils literal notranslate"><span class="pre">select_picked_times()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.shift_nxcorr"><code class="docutils literal notranslate"><span class="pre">shift_nxcorr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.shift_xcorr"><code class="docutils literal notranslate"><span class="pre">shift_xcorr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.xcorr"><code class="docutils literal notranslate"><span class="pre">xcorr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.detect.xcorr2d"><code class="docutils literal notranslate"><span class="pre">xcorr2d()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.dsp">das4whales.dsp module</a><ul>
<li><a class="reference internal" href="#das4whales.dsp.bp_filt"><code class="docutils literal notranslate"><span class="pre">bp_filt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.butterworth_filter"><code class="docutils literal notranslate"><span class="pre">butterworth_filter()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.calc_snr_median"><code class="docutils literal notranslate"><span class="pre">calc_snr_median()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.fk_filt"><code class="docutils literal notranslate"><span class="pre">fk_filt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.fk_filter_design"><code class="docutils literal notranslate"><span class="pre">fk_filter_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.fk_filter_design_old"><code class="docutils literal notranslate"><span class="pre">fk_filter_design_old()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.fk_filter_filt"><code class="docutils literal notranslate"><span class="pre">fk_filter_filt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.fk_filter_sparsefilt"><code class="docutils literal notranslate"><span class="pre">fk_filter_sparsefilt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.get_fx"><code class="docutils literal notranslate"><span class="pre">get_fx()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.get_spectrogram"><code class="docutils literal notranslate"><span class="pre">get_spectrogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.hybrid_filter_design"><code class="docutils literal notranslate"><span class="pre">hybrid_filter_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.hybrid_gs_filter_design"><code class="docutils literal notranslate"><span class="pre">hybrid_gs_filter_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.hybrid_ninf_filter_design"><code class="docutils literal notranslate"><span class="pre">hybrid_ninf_filter_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.hybrid_ninf_gs_filter_design"><code class="docutils literal notranslate"><span class="pre">hybrid_ninf_gs_filter_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.instant_freq"><code class="docutils literal notranslate"><span class="pre">instant_freq()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.moving_average"><code class="docutils literal notranslate"><span class="pre">moving_average()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.moving_average_matrix"><code class="docutils literal notranslate"><span class="pre">moving_average_matrix()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.normalize_median"><code class="docutils literal notranslate"><span class="pre">normalize_median()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.normalize_std"><code class="docutils literal notranslate"><span class="pre">normalize_std()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.snr_tr_array"><code class="docutils literal notranslate"><span class="pre">snr_tr_array()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.taper_data"><code class="docutils literal notranslate"><span class="pre">taper_data()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.dsp.taper_data2d"><code class="docutils literal notranslate"><span class="pre">taper_data2d()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.improcess">das4whales.improcess module</a><ul>
<li><a class="reference internal" href="#das4whales.improcess.angle_fromspeed"><code class="docutils literal notranslate"><span class="pre">angle_fromspeed()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.apply_median_filter_chunk"><code class="docutils literal notranslate"><span class="pre">apply_median_filter_chunk()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.apply_smooth_mask"><code class="docutils literal notranslate"><span class="pre">apply_smooth_mask()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.bilateral_filter"><code class="docutils literal notranslate"><span class="pre">bilateral_filter()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.binning"><code class="docutils literal notranslate"><span class="pre">binning()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.compute_radon_transform"><code class="docutils literal notranslate"><span class="pre">compute_radon_transform()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.detect_diagonal_edges"><code class="docutils literal notranslate"><span class="pre">detect_diagonal_edges()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.detect_long_lines"><code class="docutils literal notranslate"><span class="pre">detect_long_lines()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.diagonal_edge_detection"><code class="docutils literal notranslate"><span class="pre">diagonal_edge_detection()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.gabor_filt_design"><code class="docutils literal notranslate"><span class="pre">gabor_filt_design()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.gaussian_filter"><code class="docutils literal notranslate"><span class="pre">gaussian_filter()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.gradient_oriented"><code class="docutils literal notranslate"><span class="pre">gradient_oriented()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.par_medfilt"><code class="docutils literal notranslate"><span class="pre">par_medfilt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.scale_pixels"><code class="docutils literal notranslate"><span class="pre">scale_pixels()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.improcess.trace2image"><code class="docutils literal notranslate"><span class="pre">trace2image()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.loc">das4whales.loc module</a><ul>
<li><a class="reference internal" href="#das4whales.loc.cal_variance_residuals"><code class="docutils literal notranslate"><span class="pre">cal_variance_residuals()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_arrival_times"><code class="docutils literal notranslate"><span class="pre">calc_arrival_times()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_covariance_matrix"><code class="docutils literal notranslate"><span class="pre">calc_covariance_matrix()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_distance_matrix"><code class="docutils literal notranslate"><span class="pre">calc_distance_matrix()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_phi_vector"><code class="docutils literal notranslate"><span class="pre">calc_phi_vector()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_radii_matrix"><code class="docutils literal notranslate"><span class="pre">calc_radii_matrix()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_theta_vector"><code class="docutils literal notranslate"><span class="pre">calc_theta_vector()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.calc_uncertainty_position"><code class="docutils literal notranslate"><span class="pre">calc_uncertainty_position()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.loc.solve_lq"><code class="docutils literal notranslate"><span class="pre">solve_lq()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.map">das4whales.map module</a><ul>
<li><a class="reference internal" href="#das4whales.map.flatten_bathy"><code class="docutils literal notranslate"><span class="pre">flatten_bathy()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.latlon_to_utm"><code class="docutils literal notranslate"><span class="pre">latlon_to_utm()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.load_bathymetry"><code class="docutils literal notranslate"><span class="pre">load_bathymetry()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.load_cable_coordinates"><code class="docutils literal notranslate"><span class="pre">load_cable_coordinates()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.plot_cables2D"><code class="docutils literal notranslate"><span class="pre">plot_cables2D()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.plot_cables2D_m"><code class="docutils literal notranslate"><span class="pre">plot_cables2D_m()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.plot_cables3D"><code class="docutils literal notranslate"><span class="pre">plot_cables3D()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.map.plot_cables3D_m"><code class="docutils literal notranslate"><span class="pre">plot_cables3D_m()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.plot">das4whales.plot module</a><ul>
<li><a class="reference internal" href="#das4whales.plot.design_mf"><code class="docutils literal notranslate"><span class="pre">design_mf()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.detection_grad"><code class="docutils literal notranslate"><span class="pre">detection_grad()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.detection_mf"><code class="docutils literal notranslate"><span class="pre">detection_mf()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.detection_spectcorr"><code class="docutils literal notranslate"><span class="pre">detection_spectcorr()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.import_parula"><code class="docutils literal notranslate"><span class="pre">import_parula()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.import_roseus"><code class="docutils literal notranslate"><span class="pre">import_roseus()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_3calls"><code class="docutils literal notranslate"><span class="pre">plot_3calls()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_cross_correlogram"><code class="docutils literal notranslate"><span class="pre">plot_cross_correlogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_cross_correlogramHL"><code class="docutils literal notranslate"><span class="pre">plot_cross_correlogramHL()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_fk_domain"><code class="docutils literal notranslate"><span class="pre">plot_fk_domain()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_fx"><code class="docutils literal notranslate"><span class="pre">plot_fx()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_rawdata"><code class="docutils literal notranslate"><span class="pre">plot_rawdata()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_spectrogram"><code class="docutils literal notranslate"><span class="pre">plot_spectrogram()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_tx"><code class="docutils literal notranslate"><span class="pre">plot_tx()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_tx_env"><code class="docutils literal notranslate"><span class="pre">plot_tx_env()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.plot_tx_lined"><code class="docutils literal notranslate"><span class="pre">plot_tx_lined()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.plot.snr_matrix"><code class="docutils literal notranslate"><span class="pre">snr_matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-das4whales.tools">das4whales.tools module</a><ul>
<li><a class="reference internal" href="#das4whales.tools.disp_comprate"><code class="docutils literal notranslate"><span class="pre">disp_comprate()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.energy_TimeDomain"><code class="docutils literal notranslate"><span class="pre">energy_TimeDomain()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.filtfilt"><code class="docutils literal notranslate"><span class="pre">filtfilt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.filtfilt_chunk"><code class="docutils literal notranslate"><span class="pre">filtfilt_chunk()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.fk_filt"><code class="docutils literal notranslate"><span class="pre">fk_filt()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.fk_filt_chunk"><code class="docutils literal notranslate"><span class="pre">fk_filt_chunk()</span></code></a></li>
<li><a class="reference internal" href="#das4whales.tools.spec"><code class="docutils literal notranslate"><span class="pre">spec()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>